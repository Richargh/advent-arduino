/*********************************************************************
Christmas example, based on the Adafruit example code
*********************************************************************/

#include <SPI.h>
#include <Wire.h>
#include <Adafruit_GFX.h>
#include <Adafruit_SSD1306.h>

// SCL GPIO5
// SDA GPIO4
#define OLED_RESET 0  // GPIO0
Adafruit_SSD1306 display(OLED_RESET);

#define NUMFLAKES 10
#define XPOS 0
#define YPOS 1
#define DELTAY 2

#define STERN_HEIGHT 16
#define STERN_WIDTH  16
static const unsigned char PROGMEM stern_bmp[] ={ 
  B00000000, B11000000,
  B00000001, B11000000,
  B00000001, B11000000,
  B00000011, B11100000,
  B11110011, B11100000,
  B11111110, B11111000,
  B01111110, B11111111,
  B00110011, B10011111,
  B00011111, B11111100,
  B00001101, B01110000,
  B00011011, B10100000,
  B00111111, B11100000,
  B00111111, B11110000,
  B01111100, B11110000,
  B01110000, B01110000,
  B00000000, B00110000 
};

#define LOGO_WIDTH    48
#define LOGO_HEIGHT   48
// https://javl.github.io/image2cpp/ hintergrund schwarz mit weisser Figur
static const unsigned char PROGMEM santa_bmp [] = {
  0x00, 0x00, 0x0f, 0xfc, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x80, 0x80, 0x00, 0x03, 0xe0, 0x03, 
  0xf3, 0xf0, 0x00, 0x07, 0x00, 0x00, 0x7f, 0x38, 0x00, 0x0e, 0x00, 0x00, 0x0e, 0x18, 0x00, 0x18, 
  0x00, 0x00, 0x0c, 0x0c, 0x00, 0x30, 0x00, 0x01, 0x8c, 0x0c, 0x00, 0x70, 0x00, 0x01, 0xcc, 0x18, 
  0x00, 0x60, 0x00, 0x00, 0xcf, 0x38, 0x00, 0x60, 0x00, 0x00, 0x7f, 0xf0, 0x00, 0xc0, 0x00, 0x00, 
  0x70, 0xc0, 0x00, 0xc0, 0x00, 0x00, 0x30, 0x00, 0x00, 0xc0, 0x00, 0x00, 0x30, 0x00, 0x00, 0xc0, 
  0x00, 0x00, 0x30, 0x00, 0x01, 0xff, 0xc6, 0x7f, 0xf8, 0x00, 0x03, 0xff, 0xe6, 0x7f, 0xfc, 0x00, 
  0x03, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x03, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x03, 0x00, 0x00, 0x00, 
  0x0c, 0x00, 0x03, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x0f, 0xff, 0xff, 0xff, 0xff, 0x00, 0x1f, 0xb0, 
  0x00, 0x00, 0xdf, 0x80, 0x19, 0xa0, 0x00, 0x00, 0xd9, 0x80, 0x31, 0xa0, 0x00, 0x00, 0xd9, 0x80, 
  0x33, 0x31, 0x80, 0x10, 0xd9, 0x80, 0x1b, 0x30, 0x80, 0x10, 0xc9, 0x80, 0x1f, 0x30, 0x3f, 0xc0, 
  0xcf, 0x80, 0x0f, 0x39, 0xf9, 0xf9, 0xcf, 0x00, 0x03, 0x1f, 0xc0, 0x3f, 0x8c, 0x00, 0x03, 0x00, 
  0x00, 0x00, 0x0c, 0x00, 0x03, 0x00, 0x30, 0xc0, 0x0c, 0x00, 0x03, 0x00, 0x1f, 0x80, 0x0c, 0x00, 
  0x06, 0x00, 0x0f, 0x00, 0x0c, 0x00, 0x06, 0x00, 0x00, 0x00, 0x06, 0x00, 0x06, 0x00, 0x00, 0x00, 
  0x06, 0x00, 0x06, 0x00, 0x00, 0x00, 0x06, 0x00, 0x06, 0x00, 0x00, 0x00, 0x06, 0x00, 0x06, 0x00, 
  0x00, 0x00, 0x06, 0x00, 0x03, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x03, 0x80, 0x00, 0x00, 0x18, 0x00, 
  0x01, 0xe0, 0x00, 0x00, 0x78, 0x00, 0x00, 0xfe, 0x00, 0x07, 0xe0, 0x00, 0x00, 0x1f, 0x00, 0x0f, 
  0x80, 0x00, 0x00, 0x01, 0x80, 0x18, 0x00, 0x00, 0x00, 0x01, 0xc0, 0x38, 0x00, 0x00, 0x00, 0x00, 
  0xe0, 0x70, 0x00, 0x00, 0x00, 0x00, 0x7f, 0xe0, 0x00, 0x00, 0x00, 0x00, 0x1f, 0x80, 0x00, 0x00
};

const unsigned char foto_mit_bmp [] PROGMEM = {
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0f, 0x80, 0x00, 0x00, 0x00, 0x00, 0x0f, 0x80, 0x30, 
	0x00, 0x00, 0x00, 0x0c, 0x00, 0x70, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x70, 0x00, 0x00, 0x00, 0x0c, 
	0x1c, 0x78, 0xe0, 0x00, 0x00, 0x0c, 0x3e, 0xf9, 0xf0, 0x00, 0x00, 0x0f, 0xb7, 0x73, 0xb0, 0x00, 
	0x00, 0x0f, 0x37, 0x73, 0x30, 0x00, 0x00, 0x0c, 0x37, 0x73, 0x30, 0x00, 0x00, 0x0c, 0x37, 0x73, 
	0x30, 0x00, 0x00, 0x0c, 0x37, 0x73, 0x30, 0x00, 0x00, 0x0c, 0x37, 0x33, 0x30, 0x00, 0x00, 0x0c, 
	0x3e, 0x3b, 0xf0, 0x00, 0x00, 0x0c, 0x1e, 0x39, 0xe0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x0c, 0x00, 0x18, 0x00, 0x00, 0x00, 0x0c, 0xc0, 0x18, 0x00, 0x00, 0x00, 0x0c, 0xc0, 0x18, 
	0x00, 0x00, 0x00, 0x00, 0xc0, 0x18, 0x00, 0x00, 0x3f, 0xcd, 0xf0, 0x78, 0xe3, 0xfc, 0x3f, 0xcd, 
	0xf0, 0xf9, 0xf7, 0xfc, 0x36, 0xec, 0xc0, 0xd9, 0xb7, 0x6c, 0x36, 0xec, 0xc0, 0xd9, 0xb7, 0x6c, 
	0x36, 0xec, 0xc0, 0xd9, 0xb7, 0x6c, 0x36, 0xec, 0xc1, 0xd9, 0xf7, 0x6c, 0x36, 0xec, 0xc0, 0xd9, 
	0x87, 0x6c, 0x36, 0xec, 0xc0, 0xd9, 0x87, 0x6c, 0x36, 0xec, 0xf0, 0xf9, 0xf7, 0x6c, 0x36, 0xec, 
	0x70, 0x78, 0xf7, 0x6c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

const unsigned char frohes_fest_bmp [] PROGMEM = {
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x01, 0xc0, 0x00, 0x00, 0x7e, 0x00, 0x01, 0xc0, 0x00, 0x00, 0x7e, 0x00, 0x01, 0xc0, 0x00, 0x00, 
	0x70, 0x00, 0x01, 0xc0, 0x00, 0x00, 0x70, 0x00, 0x01, 0xc0, 0x00, 0x00, 0x70, 0x18, 0x61, 0xd8, 
	0x18, 0x1c, 0x70, 0x78, 0xf9, 0xfc, 0x7e, 0x7e, 0x7e, 0xf9, 0xfd, 0xfe, 0x7e, 0xfe, 0x7e, 0xe1, 
	0x9d, 0xce, 0xe6, 0xf0, 0x7e, 0xe3, 0x9d, 0xce, 0xe6, 0x70, 0x70, 0xe3, 0x9d, 0xce, 0xe6, 0x78, 
	0x70, 0xe3, 0x9d, 0xce, 0xfe, 0x3c, 0x70, 0xe3, 0x9d, 0xce, 0xfe, 0x1e, 0x70, 0xe3, 0x9d, 0xce, 
	0xe0, 0x0e, 0x70, 0xe3, 0x9d, 0xce, 0xe0, 0x0e, 0x70, 0xe3, 0x9d, 0xce, 0xf6, 0x0e, 0x70, 0xe1, 
	0xf9, 0xce, 0x7e, 0xfe, 0x70, 0xe0, 0xf1, 0xce, 0x7e, 0x7c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7f, 0x00, 0x00, 0x38, 0x00, 0x00, 0x7f, 0x00, 0x00, 
	0x38, 0x00, 0x00, 0x70, 0x00, 0x00, 0x38, 0x00, 0x00, 0x70, 0x00, 0x00, 0x38, 0x00, 0x00, 0x70, 
	0x0c, 0x0c, 0x38, 0x00, 0x00, 0x70, 0x3e, 0x3f, 0x7e, 0x00, 0x00, 0x7e, 0x7f, 0x7f, 0x7e, 0x00, 
	0x00, 0x7e, 0x77, 0x70, 0x38, 0x00, 0x00, 0x7e, 0x67, 0x78, 0x38, 0x00, 0x00, 0x70, 0x67, 0x3c, 
	0x38, 0x00, 0x00, 0x70, 0xff, 0x1e, 0x38, 0x00, 0x00, 0x70, 0xff, 0x0e, 0x38, 0x00, 0x00, 0x70, 
	0xe0, 0x0f, 0x38, 0x00, 0x00, 0x70, 0x60, 0x07, 0x38, 0x00, 0x00, 0x70, 0x73, 0x47, 0x38, 0x00, 
	0x00, 0x70, 0x7f, 0x7f, 0x3e, 0x00, 0x00, 0x70, 0x3e, 0x7e, 0x1e, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

const unsigned char wuenscht_bmp [] PROGMEM = {
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x1b, 0x00, 0x00, 
	0x0c, 0x0c, 0x00, 0x0b, 0x00, 0x00, 0x0c, 0x0c, 0x00, 0x00, 0x00, 0x00, 0x0c, 0x0c, 0xe4, 0xdb, 
	0x3e, 0x78, 0xef, 0x9e, 0x6e, 0xdb, 0x3e, 0xfd, 0xef, 0xde, 0x6e, 0xdb, 0x36, 0xe1, 0x8c, 0xcc, 
	0x6e, 0x9b, 0x36, 0x73, 0x8c, 0xcc, 0x6e, 0x9b, 0x36, 0x7b, 0x8c, 0xcc, 0x7f, 0x9b, 0x36, 0x3b, 
	0x8c, 0xcc, 0x3f, 0x9b, 0x36, 0x1f, 0x8c, 0xcc, 0x3b, 0x9b, 0x36, 0x1d, 0x8c, 0xcc, 0x3b, 0x1f, 
	0x36, 0xf9, 0xec, 0xce, 0x11, 0x0e, 0x00, 0x70, 0xc0, 0x06, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

const unsigned char wuenscht2_bmp [] PROGMEM = {
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0b, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x02, 0x06, 0xc4, 0x51, 0xa1, 0x40, 0x8a, 0x27, 0x44, 0x11, 0xb1, 0x41, 0x02, 0x26, 0x6a, 0x91, 
	0x89, 0x79, 0x02, 0x36, 0x22, 0x11, 0x85, 0x0d, 0x02, 0x36, 0x33, 0x11, 0x83, 0x05, 0x82, 0x36, 
	0x00, 0x0f, 0x81, 0x48, 0x52, 0x33, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

const unsigned char gross_bmp [] PROGMEM = {
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xe3, 0x80, 0x00, 0x00, 0x00, 0x01, 0x19, 
	0x80, 0x00, 0x00, 0x00, 0x03, 0x0e, 0x31, 0x41, 0x06, 0x00, 0x03, 0x0c, 0xca, 0x28, 0x91, 0x00, 
	0x03, 0x0c, 0xca, 0x28, 0x11, 0x3c, 0x03, 0x0c, 0xc2, 0x2e, 0x18, 0x00, 0x03, 0x0c, 0xc2, 0x27, 
	0x8e, 0x00, 0x03, 0x0c, 0xc2, 0x21, 0xc7, 0x00, 0x03, 0x0c, 0xc2, 0x20, 0xc1, 0x00, 0x03, 0x0c, 
	0xc2, 0x28, 0x41, 0x00, 0x01, 0x98, 0xc3, 0x2c, 0x91, 0x00, 0x02, 0x00, 0x00, 0x01, 0x04, 0x00, 
	0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x07, 0xf8, 0x00, 0x00, 0x00, 0x00, 0x07, 0xfe, 0x00, 0x00, 
	0x00, 0x00, 0x01, 0xff, 0x80, 0x00, 0x00, 0x00, 0x00, 0x01, 0x80, 0x00, 0x00, 0x00, 0x00, 0x60, 
	0xc0, 0x00, 0x00, 0x00, 0x02, 0x38, 0xc0, 0x00, 0x00, 0x00, 0x04, 0x0e, 0x60, 0x00, 0x00, 0x00, 
	0x08, 0x06, 0x60, 0x00, 0x00, 0x00, 0x18, 0x07, 0x60, 0x00, 0x00, 0x00, 0x10, 0x03, 0x60, 0x00, 
	0x00, 0x00, 0x30, 0x02, 0x60, 0x00, 0x00, 0x00, 0x30, 0x00, 0x60, 0x00, 0x00, 0x00, 0x30, 0x00, 
	0x40, 0x00, 0x00, 0x00, 0x18, 0x00, 0xc0, 0x00, 0x00, 0x00, 0x18, 0x00, 0xc0, 0x00, 0x00, 0x00, 
	0x1c, 0x01, 0x80, 0x00, 0x00, 0x00, 0x0e, 0x01, 0x00, 0x00, 0x00, 0x00, 0x07, 0x86, 0x00, 0x00, 
	0x00, 0x00, 0x01, 0xf8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

const unsigned char meiers_bmp [] PROGMEM = {
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x60, 0x00, 0x00, 0x19, 0x96, 0x00, 0x60, 0x00, 0x00, 0x78, 0xe3, 0x00, 0x00, 
	0x00, 0x00, 0x30, 0xe3, 0x80, 0x00, 0x00, 0x00, 0x30, 0xe3, 0x80, 0x00, 0x00, 0x00, 0x30, 0xe3, 
	0x92, 0x64, 0x9b, 0x48, 0x30, 0xe3, 0xb1, 0x6c, 0xd9, 0x44, 0x30, 0xe3, 0xb1, 0x6c, 0x58, 0x60, 
	0x30, 0xe3, 0xb1, 0x6c, 0xd8, 0x70, 0x30, 0xe3, 0xb0, 0x6c, 0x18, 0x1c, 0x30, 0xe3, 0xb0, 0x6c, 
	0x18, 0x0c, 0x30, 0xe3, 0xb0, 0x6c, 0x18, 0x06, 0x30, 0xe3, 0xb1, 0x6c, 0x18, 0x44, 0x30, 0xe3, 
	0x9e, 0x67, 0x98, 0x6c, 0x78, 0xe1, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

const unsigned char eisenbahn_bmp [] PROGMEM = {
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20, 0x00, 0x00, 0x00, 
	0x00, 0x01, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x0f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x00, 0x00, 0x30, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x38, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1e, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x0f, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0xf0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x38, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x00, 0x00, 0x00, 0x00, 0x01, 
	0xf0, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xf8, 0x00, 0x00, 0x00, 
	0x01, 0x80, 0x0c, 0x07, 0xe0, 0x00, 0x03, 0x00, 0x06, 0x04, 0x20, 0x00, 0x03, 0xff, 0xfe, 0x07, 
	0xe0, 0x00, 0x01, 0x80, 0x0c, 0x02, 0x60, 0x00, 0x01, 0x1f, 0xc4, 0x02, 0x40, 0x00, 0x01, 0x1f, 
	0xc4, 0x02, 0x40, 0x00, 0x01, 0x10, 0x44, 0x02, 0x60, 0x00, 0x01, 0x10, 0x47, 0xff, 0xf0, 0x00, 
	0x01, 0x10, 0x44, 0x00, 0x18, 0x00, 0x01, 0x10, 0x44, 0x00, 0x08, 0x00, 0x01, 0x1f, 0xc4, 0x00, 
	0x08, 0x00, 0x01, 0x00, 0x04, 0x00, 0x08, 0x00, 0x01, 0x00, 0x04, 0x00, 0x08, 0x00, 0x01, 0x1f, 
	0x84, 0x00, 0x18, 0x00, 0x01, 0xf0, 0xff, 0xff, 0xf8, 0x00, 0x03, 0x60, 0xfc, 0x00, 0x08, 0x00, 
	0x02, 0x47, 0x9e, 0x00, 0x04, 0x00, 0x02, 0x4f, 0xc1, 0xe0, 0xe4, 0x00, 0x02, 0x46, 0x7c, 0x31, 
	0x36, 0x00, 0x01, 0xe0, 0x63, 0xff, 0x1c, 0x00, 0x00, 0x20, 0xc1, 0x11, 0x10, 0x00, 0x00, 0x1f, 
	0x81, 0xf1, 0xe0, 0x00, 0x00, 0x06, 0x00, 0x40, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

#if (SSD1306_LCDHEIGHT != 48)
#error("Height incorrect, please fix Adafruit_SSD1306.h!");
#endif

const int button1Pin = 2;
const int button2Pin = 3;
const int button3Pin = 4;
const int button4Pin = 5;

enum Zustand {
    WARTE, MACHE_INTERAKTION, ZEICHNE_STERNE, ZEICHNE_WERBUNG
};

Zustand zustand;
long letzerZustandInMillis;

void setzeZustand(Zustand neuerZustand) {
  zustand = neuerZustand;
  letzerZustandInMillis = millis();
}

long millisSeitLetztemZustand() {
  return millis() - letzerZustandInMillis;
}

void setup()   {
  Serial.begin(9600);

  pinMode(button1Pin, INPUT_PULLUP);
  pinMode(button2Pin, INPUT_PULLUP);
  pinMode(button3Pin, INPUT_PULLUP);
  pinMode(button4Pin, INPUT_PULLUP);

  // by default, we'll generate the high voltage from the 3.3v line internally! (neat!)
  display.begin(SSD1306_SWITCHCAPVCC, 0x3C);  // initialize with the I2C addr 0x3C (for the 64x48)

  setzeZustand(WARTE);
}

void loop() {
  int button1State = digitalRead(button1Pin);
  int button2State = digitalRead(button2Pin);
  int button3State = digitalRead(button3Pin);
  int button4State = digitalRead(button4Pin);

  if (button1State == LOW) {
    setzeZustand(MACHE_INTERAKTION);
    onButton1Push();
    setzeZustand(WARTE);
  } else if(button2State == LOW) {
    setzeZustand(MACHE_INTERAKTION);
    onButton2Push();
    setzeZustand(WARTE);
  } else if(button3State == LOW) {
    setzeZustand(MACHE_INTERAKTION);
    onButton3Push();
    setzeZustand(WARTE);
  } else if(button4State == LOW) {
    setzeZustand(WARTE);
  }

  if(zustand == WARTE && millisSeitLetztemZustand() > 3000){
    initiereSterne(stern_bmp, STERN_HEIGHT, STERN_WIDTH);
    setzeZustand(ZEICHNE_STERNE);
  }
  if(zustand == ZEICHNE_STERNE){
    if(millisSeitLetztemZustand() < 5000){
      zeichneSterne(stern_bmp, STERN_HEIGHT, STERN_WIDTH);
    } else {
      setzeZustand(ZEICHNE_WERBUNG);
    }
  }
  if(zustand == ZEICHNE_WERBUNG){
    zeichneWerbung();
  }
}

void zeichneWerbung(){
  if(millisSeitLetztemZustand() < 3000){
    zeichneBitmap(frohes_fest_bmp, LOGO_HEIGHT, LOGO_WIDTH);
  } else if(millisSeitLetztemZustand() < 6000){
    zeichneBitmap(wuenscht_bmp, LOGO_HEIGHT, LOGO_WIDTH);
  } else if(millisSeitLetztemZustand() < 9000){
    zeichneBitmap(gross_bmp, LOGO_HEIGHT, LOGO_WIDTH);
  } else if(millisSeitLetztemZustand() < 12000){
    zeichneBitmap(meiers_bmp, LOGO_HEIGHT, LOGO_WIDTH);
  } else if(millisSeitLetztemZustand() < 15000){
    zeichneBitmap(eisenbahn_bmp, LOGO_HEIGHT, LOGO_WIDTH);
    setzeZustand(WARTE);
  }
}

void onButton1Push(){
  zeichneBitmap(foto_mit_bmp, LOGO_HEIGHT, LOGO_WIDTH);
  delay(3000);
  zeichneBitmap(santa_bmp, LOGO_HEIGHT, LOGO_WIDTH);
  delay(1000);
  display.invertDisplay(true);
  delay(1000);
  display.invertDisplay(false);
  delay(2000);
}

void onButton2Push(){
  display.clearDisplay();
  display.setTextSize(1);
  display.setTextColor(WHITE);
  display.setCursor(0,0);
  display.println("Hello, world!");
  display.setTextColor(BLACK, WHITE); // 'inverted' text
  display.println("Foto Mit");
  display.setTextSize(2);
  display.setTextColor(WHITE);
  display.print("0x"); display.println(0xDEADBEEF, HEX);
  display.display();
}

void onButton3Push(){
  zeichneBitmap(santa_bmp, LOGO_HEIGHT, LOGO_WIDTH);
  delay(1);

  // invert the display
  display.invertDisplay(true);
  delay(1000);
  display.invertDisplay(false);
}

void onButton4Push(){

}

uint8_t icons[NUMFLAKES][3];

void initiereSterne(const uint8_t *bitmap, uint8_t w, uint8_t h) {
  for (uint8_t f=0; f< NUMFLAKES; f++) {
    icons[f][XPOS] = random(display.width());
    icons[f][YPOS] = 0;
    icons[f][DELTAY] = random(5) + 1;

    Serial.print("x: ");
    Serial.print(icons[f][XPOS], DEC);
    Serial.print(" y: ");
    Serial.print(icons[f][YPOS], DEC);
    Serial.print(" dy: ");
    Serial.println(icons[f][DELTAY], DEC);
  }

  return icons;
}

void zeichneSterne(const uint8_t *bitmap, uint8_t w, uint8_t h){
  display.clearDisplay();
  // draw each icon
  for (uint8_t f=0; f< NUMFLAKES; f++) {
    display.drawBitmap(icons[f][XPOS], icons[f][YPOS], bitmap, w, h, WHITE);
  }
  display.display();
  delay(200);

  // then erase it + move it
  for (uint8_t f=0; f< NUMFLAKES; f++) {
    display.drawBitmap(icons[f][XPOS], icons[f][YPOS], bitmap, w, h, BLACK);
    // move it
    icons[f][YPOS] += icons[f][DELTAY];
    // if its gone, reinit
    if (icons[f][YPOS] > display.height()) {
      icons[f][XPOS] = random(display.width());
      icons[f][YPOS] = 0;
      icons[f][DELTAY] = random(5) + 1;
    }
  }
}

void zeichneBitmap(const uint8_t *bitmap, uint8_t w, uint8_t h) {
  display.clearDisplay();

  display.drawBitmap(
    (display.width() - w) / 2,
    ((display.height() - h) / 2),
    bitmap, w, h, 1);
  display.display();
}

void testscrolltext(void) {
  display.setTextSize(2);
  display.setTextColor(WHITE);
  display.setCursor(10,0);
  display.clearDisplay();
  display.println("scroll");
  display.display();
  delay(1);

  display.startscrollright(0x00, 0x0F);
  delay(2000);
  display.stopscroll();
  delay(1000);
  display.startscrollleft(0x00, 0x0F);
  delay(2000);
  display.stopscroll();
  delay(1000);
  display.startscrolldiagright(0x00, 0x07);
  delay(2000);
  display.startscrolldiagleft(0x00, 0x07);
  delay(2000);
  display.stopscroll();
}

void testdrawcircle(void) {
  for (int16_t i=0; i<display.height(); i+=2) {
    display.drawCircle(display.width()/2, display.height()/2, i, WHITE);
    display.display();
    delay(1);
  }
}
